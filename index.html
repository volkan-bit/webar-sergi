<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WebAR Sergi</title>

  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

  <style>
    body { margin: 0; overflow: hidden; }
  </style>
</head>

<body>

<a-scene
  mindar-image="imageTargetSrc: targets.mind;"
  vr-mode-ui="enabled: false"
  device-orientation-permission-ui="enabled: true">

  <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

  <!-- QR MARKER -->
  <a-entity id="marker" mindar-image-target="targetIndex: 0">

    <!-- TABLO -->
    <a-plane
      id="artwork"
      src="resim1.jpg"
      width="1"
      height="1.4"
      scale="3 3 3"
      position="0 0.15 0">
    </a-plane>

  </a-entity>

</a-scene>

<script>
const marker = document.querySelector("#marker");
const artwork = document.querySelector("#artwork");

let locked = false;

marker.addEventListener("targetFound", () => {
  if (locked) return;
  locked = true;

  // Dünya koordinatını al
  const worldPos = new THREE.Vector3();
  marker.object3D.getWorldPosition(worldPos);

  // Resmi QR'ın üstüne sabitle
  artwork.object3D.position.set(
    worldPos.x,
    worldPos.y + 0.15,
    worldPos.z
  );

  // Marker takibini kapat
  marker.setAttribute("mindar-image-target", "enabled", false);
});
</script>

</body>
</html>
